sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/ui/model/FilterType","../model/formatter"],function(e,t,o,r,a,i,s,n,u){"use strict";return e.extend("opportunity.opportunity.controller.Overview",{formatter:u,onInit(){sap.ui.core.UIComponent.getRouterFor(this).getRoute("Overview").attachPatternMatched(this._onRoutePatternMatched,this);var e=new r({});this.getView().setModel(e,"localModel")},_onRoutePatternMatched:function(e){var t=this.getView().byId("smartChart1");if(t.isInitialised())t.rebindChart();var o=this.getView().byId("smartChart2");if(o.isInitialised())o.rebindChart();var r=this.getView().byId("smartChart3");if(r.isInitialised())r.rebindChart();this.onReadDataOpportunities();this.onReadDataTasks()},onRebindUtilizationChart:function(e){var t=e.getParameter("bindingParams");var o=new sap.ui.model.Sorter("order",false);t.sorter.push(o)},onBeforeRebindMUChart:function(e){var t=e.getParameter("bindingParams");var o=new sap.ui.model.Sorter("marketUnit",false);t.sorter.push(o)},onSubmitFeedback:function(e){var o=this;var r=this.getView().getModel("localModel");var a=r.getData();var i=this.getOwnerComponent().getModel("user").getProperty("/firstname");var n;if(a.positive===true)n=true;else if(a.negative===true)n=false;var u={feedback:a.feedback,positive:n,postedBy:i,postedOn:new Date};o.getView().setBusy(true);var d=o.getView().getModel();d.create("/userFeedback",u,{success:function(e,t){s.show("Your Feedback has been registered. Thank you!");o.getView().setBusy(false)},error:function(e){o.getView().setBusy(false);t.error("Your feedback could not be submitted at this time. Please refresh and try again.")}})},onTogglePositiveFeedback:function(){var e=this.getView().getModel("localModel");e.setProperty("/positive",true);e.setProperty("/negative",false)},onToggleNegativeFeedback:function(){var e=this.getView().getModel("localModel");e.setProperty("/positive",false);e.setProperty("/negative",true)},onReadDataOpportunities:function(){var e=this;var t=e.getView().getModel("localModel");var o=e.getView().getModel();o.read("/opportunityHeader",{success:function(e){var o=e.results.length;t.setProperty("/opportunityHeaderLength",o)}.bind(this),error:function(e){console.log(e)}})},onReadDataTasks:function(){var e=this;var t=e.getView().getModel("localModel");var o=e.getView().getModel();o.read("/opportunityActionItems",{success:function(e){var o=e.results.length;t.setProperty("/opportunityActionItemsLength",o)}.bind(this),error:function(e){console.log(e)}})},onNavToOpportunities:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("MainReport")},onNavToTasks:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("TasksReport")}})});