sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/library","sap/ui/core/Fragment","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/base/Log","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,o,n,r,i,a,s,p,u,c,l){"use strict";return e.extend("opportunity.opportunity.controller.App",{formatter:n,onInit(){var e=new u({});this.getView().setModel(e,"localModel")},getRouter:function(){return p.getRouterFor(this)},onHomeIconPressed:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("Overview")},onOpenSAPOne:function(){var e="https://one.int.sap/home";t.URLHelper.redirect(e,true)},onOpenSharePoint:function(){var e="https://sap.sharepoint.com/sites/201967";t.URLHelper.redirect(e,true)},onOpenServiceCatalog:function(){var e="https://servicescatalog.cvdp3eof-dbsservic1-p1-public.model-t.cc.commerce.ondemand.com/";t.URLHelper.redirect(e,true)},onOpenAnalyticsStore:function(){var e="https://eas.sap.com/astore/ui/index.html#assets";t.URLHelper.redirect(e,true)},onNavToTasksPage:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);var o=e.getSource();var n=window.location.href.split("#")[1];if(n!=""&&o.getText()!="Go to Tasks"){t.navTo("MainReport");o.setText("Go to Tasks")}else{t.navTo("TasksReport");o.setText("Go to Opportunities")}},onNavToOpportunities:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("MainReport")},onNavToProjectOverview:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("ProjectOverview")},onNavToTasks:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("TasksReport")},onToggleSideMenu:function(e){var t=this.byId("toolPage");var o=t.getSideExpanded();t.setSideExpanded(!o)},onOpenAbout:function(e){this.onDialogOpen("opportunity.opportunity.view.fragments.InfoPopup")},onOpenTeam:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("Team")},onOpenResources:function(e){this.onOpenPopover(e,"opportunity.opportunity.view.fragments.TeamSelection")},onOpenPopover:function(e,t){var n=e.getSource(),r=this.getView();if(!this._pPopover){this._pPopover=o.load({id:r.getId(),name:t,controller:this}).then(function(e){r.addDependent(e);return e})}this._pPopover.then(function(e){e.openBy(n)})},onCancelDialogPress:function(e){this.editDialog=false;this._pDialog.then(function(e){e.close();e.destroy()});this._pDialog=null;this.getView().getModel("localModel").setData({})},onDialogOpen:function(e){var t=this;if(!this._pDialog){this._pDialog=o.load({name:e,controller:this}).then(function(e){t.getView().addDependent(e);e.setEscapeHandler(function(){t.onCloseDialog()});return e})}this._pDialog.then(function(e){e.open()})},onOpenCalendar:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("Calendar")},onSelectTeamMember:function(e){var t=e.getSource().getBindingContext().getObject().inumber;var o=sap.ui.core.UIComponent.getRouterFor(this);o.navTo("Resources",{inumber:t})},onSearchTeamMember:function(e){var t=[];var o=e.getSource().getValue();if(o&&o.length>0){var t=[new r({filters:[new r({path:"firstName",operator:i.Contains,value1:o,caseSensitive:false}),new r({path:"lastName",operator:i.Contains,value1:o,caseSensitive:false})],and:false})]}var n=this.byId("teamMemberList").getBinding("items");n.filter(t,a.Application)},onSubmitFeedback:function(e){var t=this;var o=this.getView().getModel("localModel");var n=o.getData();var r=this.getOwnerComponent().getModel("user").getProperty("/firstname");var i;if(n.positive===true)i=true;else if(n.negative===true)i=false;var a={feedback:n.feedback,positive:i,postedBy:r,postedOn:new Date};t.getView().setBusy(true);var s=t.getView().getModel();s.create("/userFeedback",a,{success:function(e,o){c.show("Your Feedback has been registered. Thank you!");t.getView().setBusy(false)},error:function(e){t.getView().setBusy(false);l.error("Your feedback could not be submitted at this time. Please refresh and try again.")}})},onTogglePositiveFeedback:function(){var e=this.getView().getModel("localModel");e.setProperty("/positive",true);e.setProperty("/negative",false)},onToggleNegativeFeedback:function(){var e=this.getView().getModel("localModel");e.setProperty("/positive",false);e.setProperty("/negative",true)}})});